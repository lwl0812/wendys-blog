---
_title: 正则表达式必知必会-重复匹配
description: 正则表达式
sidebar: auto
displayAllHeaders: true
tag: JavaScript
public: false
---

# 5. 正则表达式必知必会-重复匹配

## 5.1 有多少个匹配

匹配电子邮箱。

\w@\w\.\w 只能匹配 a@b.c 这样的邮箱，不能匹配 abcd@dbcd.com 这样的邮箱地址。

### 5.1.1 匹配一个或多个字符

匹配同一个字符或字符集的多次重复，可以用字符 +，匹配一个或多个字符。

```js
const email1 = 'luwl@qq.com';
const email2 = 'luwl2@163.com';
const reg = /\w+@\w+\.\w+/; // 此处正则不能使用全局 g，否则，下面第二个 console 打印出来是 false，参考下面
console.log(reg.test(email1)); // true
console.log(reg.test(email2)); // true
```

[正则 global flag](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#Using_test()_on_a_regex_with_the_global_flag)


匹配一个或多个字符集

```js
const str =
  'Send personal email to luwl@qq.com or luwl.p@qq.com. For questions use support@qq.com or support@vip.qq.com.';
const reg = /\w+@\w+\.\w+/g;
let match;
while ((match = reg.exec(str))) {
  console.log(`匹配项: ${match[0]}, index: ${match.index}`);
}
// 匹配项: luwl@qq.com, index: 23
// 匹配项: p@qq.com, index: 43 <-- 不对
// 匹配项: support@qq.com, index: 71
// 匹配项: support@vip.qq, index: 89 <-- 不对
```

```js
const str =
  'Send personal email to luwl@qq.com or luwl.p@qq.com. For questions use support@qq.com. If your message is urgent try support@vip.qq.com.';
const reg = /[\w\.]+@[\w\.]+\.\w+/g; // <-- 修改正则，匹配字符集 [\w\.]
let match;
while ((match = reg.exec(str))) {
  console.log(`匹配项: ${match[0]}, index: ${match.index}`);
}
// 匹配项: luwl@qq.com, index: 23
// 匹配项: luwl.p@qq.com, index: 38
// 匹配项: support@qq.com, index: 71
// 匹配项: support@vip.qq.com, index: 89
```

### 5.1.2 匹配零个或多个字符

元字符 + 匹配一个或多个字符，元字符 * 匹配零个或多个字符。

```js
const str = '.luwl@qq.com';
const reg1 = /[\w\.]+@[\w\.]+\.\w+/;
console.log(reg1.exec(str)); // [".luwl@qq.com", index: 0, input: ".luwl@qq.com", groups: undefined]
// email 的开头是点，不符合 email 的格式
const reg2 = /\w+[\w\.]+@[\w\.]+\.\w+/;
console.log(reg2.exec(str)); // ["luwl@qq.com", index: 1, input: ".luwl@qq.com", groups: undefined]
const reg3 = /\w+[\w\.]*@[\w\.]+\.\w+/; // <-- * 前面的是可选的
console.log(reg3.exec(str)); // ["luwl@qq.com", index: 1, input: ".luwl@qq.com", groups: undefined]
```

### 5.1.3 匹配零个或一个字符

元字符 ?，匹配一个字符或字符集的 0 次或 1次。

```js
const str =
  'The url is http://wendys.com/, to connect securely use https://wendys.com/ . This is a wrong url: httpssssss://wendys.com/ .';
const reg1 = /http:\/\/[\w\./]+/g;
let match1;
while ((match1 = reg1.exec(str))) {
  console.log(match1[0]);
}
// http://wendys.com/
// 匹配不到 https://wendys.com
const reg2 = /https*:\/\/[\w\./]+/g; // <-- 匹配 0 次或多次 s
let match2;
while ((match2 = reg2.exec(str))) {
  console.log(match2[0]);
}
// http://wendys.com/
// https://wendys.com/
// httpssssss://wendys.com/ <-- 匹配到错误的 url
const reg3 = /https?:\/\/[\w\./]+/g; // <-- 匹配 0 次或 1 次 s
let match3;
while ((match3 = reg3.exec(str))) {
  console.log(match3[0]);
}
// http://wendys.com/
// https://wendys.com/
```