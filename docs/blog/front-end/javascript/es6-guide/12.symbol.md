---
_title: Symbol
description: ES6
sidebar: auto
displayAllHeaders: true
tag: JavaScript
public: false
---

# Symbol

## 1. 概述

Symbol 可以保证每个属性的名字都是独一无二的，从根本上防止属性名的冲突。

Symbol 是原始数据类型。

```js
const s = Symbol();
console.log(typeof s); // 'symbol'
```

Symbol 函数前不能使用 new，否则会报错。

这是因为生成的 Symbol 是一个原始类型的值，不是对象，所以不能添加属性。它是一种类似于字符串的数据类型。

可以接受一个字符串作为参数，描述 Symbol 实例，便于区分。

```js
const a = Symbol('a');
const b = Symbol('b');
console.log(a); // Symbol(a)
console.log(b); // Symbol(b)
console.log(a.toString()); // 'Symbol(a)'
console.log(b.toString()); // 'Symbol(b)'
```

如果字符串是对象，会先调用对象的 ```toString``` 方法，转成字符串再生成一个 ```Symbol``` 值。

```js
console.log(Symbol({})); // Symbol([object Object]);
```

> 注：参数只是对实例的描述，相同参数的 Symbol 函数返回的值是不相等的。

```js
const symbol1 = Symbol();
const symbol2 = Symbol();
console.log(symbol1 === symbol2); // false
const symbolA = Symbol('a');
const symbolB = Symbol('a');
console.log(symbolA === symbolB); // false
```

Symbol 值不能与其他类型的值进行运算，会报错。

```js
const symbol = Symbol('my symbol');
console.log('Your name is ' + symbol); // Cannot convert a Symbol value to a string
```

可以显示地将 Symbol 值 转为字符串。

```js
const symbol = Symbol('my symbol');
console.log(String(symbol)); // "Symbol(my symbol)"
console.log(symbol.toString()); // "Symbol(my symbol)"
```

也可以转为布尔值，但不能转为数值。

```js
const symbol = Symbol('my symbol');
console.log(Boolean(symbol)); // true
console.log(!symbol); // false
console.log(Number(symbol)); // Cannot convert a Symbol value to a number
```

## 2. Symbol.prototype.description

```js
const symbol = Symbol('my symbol');
```

上面的代码中，'my symbol' 就是 symbol 的 description。

读取这个描述，需要显示转为字符串：

```js
console.log(String(symbol)); // "Symbol(my symbol)"
```

ES2019 提供了 description，可直接读取。

```js
const symbol = Symbol('my symbol');
console.log(symbol.description); // 'my symbol'
```

## 3. 作为属性名的 Symbol

每个 Symbol 值都是不相等的，所以可以作为标识符用于对象的属性名，保证不会出现同名的属性。

```js
// 第一种
const obj = {};
obj[symbol] = 'Hello';
// 第二种
const obj = {
  [symbol]: 'Hello',
};
// 第三种
const obj = {};
Object.defineProperty(obj, symbol, {
  value: 'Hello',
});
console.log(obj[symbol]); // 'Hello'
```

Symbol 值作为属性名时不能用点运算符。

```js
const obj = {};
obj.symbol = 'Hello'; // <-- 点运算符后面总是字符串，所以不会读取 symbol 作为标识名所指代的值
console.log(obj[symbol]); // undefined
console.log(obj['symbol']); // 'Hello'
```

## 4. 实例：消除魔术字符串

```js
const getArea = shape => {
  switch (shape) {
    case 'triangle': // triangle 是魔术字符串，用到好多次
      console.log('triangle');
      break;
  }
};
getArea('triangle'); // 'triangle'
```

```js
const shapeType = {
  triangle: Symbol('triangle'), // 用 Symbol 值代替属性值，防止冲突
};
const getArea = shape => {
  switch (shape) {
    case shapeType.triangle: // 用变量代替魔术字符串
      console.log(shape);
      break;
  }
};
getArea(shapeType.triangle); // Symbol(triangle)
```
