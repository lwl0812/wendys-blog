---
_title: 数值的扩展
description: ES6
sidebar: auto
displayAllHeaders: true
tag: JavaScript
public: false
---

# 数值的扩展

## 二进制和八进制表示法

ES6 提供了二进制和八进制数值的新写法，分别用 0b（oB) 和 0o（0O）表示。

将 0b 和 0o 前缀的数字转化成十进制，用 Number() 方法。

```js
Number('0b11'); // 3
Number('0011'); // 9
```

## Number.isFinite() Number.isNaN()

Number.isFinite() 用来检查数值是否为有限的。

```js
Number.isFinite(1); // true
Number.isFinite('15'); // false
Number.isFinite(NaN); // false
Number.isFinite(Infinity); // false
Number.isFinite(-Infinity); // false
Number.isFinite(''); // false
Number.isFinite(true); // false
```

参数类型不是数值，一律返回 false。

Number.isNaN()

略...

## Number.parseInt() Number.parseFloat()

将全局方法 parseInt() parseFloat() 移植到 Number 对象上。

## Number.isInteger()

判断一个数值是否为整数。

```js
Number.isInteger(20); // true
Number.isInteger(20.1); // false
Number.isInteger(20.0); // true
// 精度问题 产生误判
Number.isInteger(3.0000000000000002); // true
```

如果对数据精度的要求较高，不建议使用Number.isInteger()判断一个数值是否为整数。

## Number.EPSILON

略

## 安全整数和 Number.isSafeInteger()

JavaScript 能准确表示的整数范围在 ```-2^53```和 ```2^53```之间，超过这个范围无法精确表示。

```js
Math.pow(2, 53); // 9007199254740992
Math.pow(2, 53) + 1; // 9007199254740992
```

ES6 引入了 Number.MAX_SAFE_INTEGER 和 Number.MIN_SAFE_INTEGER，用来表示这两个范围的上下限。

```js
Number.MAX_SAFE_INTEGER; // 9007199254740991
Number.MIN_SAFE_INTEGER; // -9007199254740991
```

Number.isSafeInteger 用来判断一个整数是否落在这个范围内。

```js
Number.isSafeInteger('a'); // false
Number.isSafeInteger(1); // true
Number.isSafeInteger(null); // false
Number.isSafeInteger(NaN); // false
Number.isSafeInteger(Infinity); // false
Number.isSafeInteger(-Infinity); // false
Number.isSafeInteger(1); // true
Number.isSafeInteger(1.2); // false
Number.isSafeInteger(Number.MAX_SAFE_INTEGER); // true
Number.isSafeInteger(Number.MAX_SAFE_INTEGER + 1); // false
Number.isSafeInteger(Number.MIN_SAFE_INTEGER); // true
Number.isSafeInteger(Number.MIN_SAFE_INTEGER - 1); // false
```

Number.isSafeInteger 的实现：

```js
Number.isSafeInteger = (number) => {
  return (typeof number === 'number' &&
    Math.round(number) === number &&
    Number.MIN_SAFE_INTEGER <= number &&
    number <= Number.MAX_SAFE_INTEGER);
}
```

> 注意：不止要验证计算结果，还要验证每个值。

```js
Math.pow(2, 53); // 9007199254740992
Math.pow(2, 53) + 1; // 9007199254740992

Number.isSafeInteger(9007199254740993); // false
Number.isSafeInteger(990); // true
console.log(9007199254740993 - 990); // 9007199254740002 应该是 9007199254740003
Number.isSafeInteger(9007199254740993 - 990); // true
```

## Math 对象的扩展

### Math.trunc()

去除一个数的小数部分，保留整数部分。

```js
Math.trunc(1.1); // 1
Math.trunc(-1.1); // -1
Math.trunc(0.1); // 0
Math.trunc(-0.1); // -0
```

非数值，使用 Number 方法在内部先转为数值。

```js
Math.trunc('1.11'); // 1
Math.trunc(true); // 1
Math.trunc(false); // 0
Math.trunc(null); // 0
Math.trunc(''); // 0
```

空值和无法截取整数的值，返回 NaN。

```js
Math.trunc('foo'); // NaN
Math.trunc(NaN); // NaN
Math.trunc(); // NaN
Math.trunc(undefined); // NaN   
```

模拟实现：

```js
Math.trunc = Math.trunc || function(val) {
  return val < 0 ? Math.ceil(val) : Math.floor(val);
}
```

## Math.sign()

判断一个数是正数、负数还是零。

返回结果：

- 参数是正数，返回 +1
- 参数是负数，返回 -1
- 参数是0，返回 +0
- 参数是-0，返回 -0
- 其他值，返回 NaN

```js
const { log } = console;

log(Math.sign(6)); // 1
log(Math.sign(-6)); // -1
log(Math.sign(0)); // 0
log(Math.sign(-0)); // -0
log(Math.sign(NaN)); // NaN
```

对于非数值，会先转换为数值。

```js
const { log } = console;

log(Math.sign('')); // 0
log(Math.sign(false)); // 0
log(Math.sign(true)); // 1
log(Math.sign('test')); // NaN
log(Math.sign('9')); // 1
log(Math.sign(null)); // 0
log(Math.sign(undefined)); // NaN
log(Math.sign()); // NaN
```

模式实现：

```js
const { log } = console;

Math.sign2 = Math.sign || function (x) {
  x = +x;
  if (x === 0 || isNaN(x)) {
    return x;
  }
  return x > 0 ? 1 : -1;
}

log(Math.sign2(2)); // 1
log(Math.sign2(0)); // 0
log(Math.sign2(-2)); // -1
log(Math.sign2(false)); // 0
```




